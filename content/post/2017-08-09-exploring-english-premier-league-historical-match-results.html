---
title: Exploring English Premier League Historical Match Results
author: Tyler Bradley
date: '2017-08-10'
slug: epl-opening-weekend
categories:
  - R
tags:
  - tidyverse
  - EPL
  - rstats
---



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>I was listening to <a href="https://twitter.com/codinghorror">Jeff Atwood’s</a> interview on the podcast <a href="http://developeronfire.com/">Developer on Fire</a> and he said something that struck home with me. It was along the lines of, “The best time to start blogging is yesterday.” I have been considering starting a blog about <a href="https://twitter.com/hashtag/rstats">#rstats</a> but had been putting it off because of any number of reasons. But after listening to his interview, I decided now was as good of a time as any. With the help of Yihui Xie’s <a href="https://github.com/rstudio/blogdown">blogdown</a>, I was able to set up the basic webpage pretty easily too.</p>
<p>So In honor of the start of a new season for the English Premier League (EPL), I put together this exploratory data analysis of historical EPL data to see how teams typically do to start a season. I would love any feed back and suggestions! Please feel free to follow me on <a href="twitter%20https://twitter.com/tb_goonR">twitter</a> (I just created it this past week to better keep up with #rstats rather than just continually googling it as I have been for the last year.)</p>
</div>
<div id="general-data-analysis" class="section level1">
<h1>General Data Analysis</h1>
<pre class="r"><code># loading in the required packages
suppressWarnings(suppressPackageStartupMessages({
  library(tidyr)
  library(ggplot2)
  library(lubridate)
  library(magrittr)
  library(tidyquant)
  library(purrr)
  library(ggjoy)
  library(dplyr)
}))</code></pre>
<p>First, we will load in the data. All of the data used in this analysis is from &lt;www.football-data.co.uk&gt;, and can be found on <a href="https://github.com/tbradley1013/epl">my github page</a> under the epl repository.</p>
<pre class="r"><code>files &lt;- list.files(path = &quot;epl_results&quot;, full.names = TRUE)

raw_data &lt;- map(files, read.csv)</code></pre>
<p>Below is the column information provided by the website:</p>
<pre><code>* Div = League Division
* Date = Match Date (dd/mm/yy)
* HomeTeam = Home Team
* AwayTeam = Away Team
* FTHG = Full Time Home Team Goals
* FTAG = Full Time Away Team Goals
* FTR = Full Time Result (H=Home Win, D=Draw, A=Away Win) 
* HTHG = Half Time Home Team Goals 
* HTAG = Half Time Away Team Goals 
* HTR = Half Time Result (H=Home Win, D=Draw, A=Away Win)</code></pre>
<p>Match Statistics (where available):</p>
<pre><code>* Attendance = Crowd Attendance
* Referee = Match Referee
* HS = Home Team Shots
* AS = Away Team Shots
* HST = Home Team Shots on Target
* AST = Away Team Shots on Target
* HHW = Home Team Hit Woodwork
* AHW = Away Team Hit Woodwork
* HC = Home Team Corners
* AC = Away Team Corners
* HF = Home Team Fouls Committed
* AF = Away Team Fouls Committed
* HO = Home Team Offsides
* AO = Away Team Offsides
* HY = Home Team Yellow Cards
* AY = Away Team Yellow Cards
* HR = Home Team Red Cards
* AR = Away Team Red Cards</code></pre>
<p>There are more columns provided in the raw data set that have to do with betting odds, however, we will remove them as they are not going to be used in this analysis. Additionally, only two seasons data has attendance recorded, so this will be removed. Looking through the data, all of the data sets for the 2000/2001 through the 2016/2017 seasons have all of the match statistics listed above. The data sets prior to the 2000/2001 data set only have the general data and none of the match statistics. Because of these differences in available data we will only use the general statistics for the first part of this analysis.</p>
<pre class="r"><code>data_general &lt;- map(raw_data, function(x){
  output &lt;- x %&gt;%
    filter(Date != &quot;&quot;) %&gt;%  #the csv files pulled in some extra rows, this line removes them
    mutate(Date = dmy(Date)) %&gt;% #converting the Date column from a factor to date object
    select(Div:HTR) %&gt;%
    mutate(season = ifelse(month(Date) &gt; 7,
                                   year(Date) + 1,
                                    year(Date)))  #creating a reference date 
  return(output)
})

data &lt;- do.call(rbind, data_general) %&gt;% as.tibble()</code></pre>
<pre class="r"><code>data </code></pre>
<pre><code>## # A tibble: 8,360 x 11
##       Div       Date    HomeTeam       AwayTeam  FTHG  FTAG    FTR  HTHG
##    &lt;fctr&gt;     &lt;date&gt;      &lt;fctr&gt;         &lt;fctr&gt; &lt;int&gt; &lt;int&gt; &lt;fctr&gt; &lt;int&gt;
##  1     E0 1995-08-19 Aston Villa     Man United     3     1      H     3
##  2     E0 1995-08-19   Blackburn            QPR     1     0      H     1
##  3     E0 1995-08-19     Chelsea        Everton     0     0      D     0
##  4     E0 1995-08-19   Liverpool Sheffield Weds     1     0      H     0
##  5     E0 1995-08-19    Man City      Tottenham     1     1      D     0
##  6     E0 1995-08-19   Newcastle       Coventry     3     0      H     1
##  7     E0 1995-08-19 Southampton  Nott&#39;m Forest     3     4      A     1
##  8     E0 1995-08-19    West Ham          Leeds     1     2      A     1
##  9     E0 1995-08-19   Wimbledon         Bolton     3     2      H     2
## 10     E0 1995-08-20     Arsenal  Middlesbrough     1     1      D     1
## # ... with 8,350 more rows, and 3 more variables: HTAG &lt;int&gt;, HTR &lt;fctr&gt;,
## #   season &lt;dbl&gt;</code></pre>
<p>Now that the data from the csv files is all in one data frame, we can do some manipulation to get it into a more tidy format.</p>
<pre class="r"><code>data_tidy &lt;- data %&gt;%
  gather(key = &quot;venue&quot;, value = team, HomeTeam:AwayTeam) %&gt;% 
  arrange(Date) %&gt;%
  mutate_if(is.factor, as.character) %&gt;%
  mutate(venue = ifelse(venue == &quot;HomeTeam&quot;,
                        &quot;Home&quot;,
                        &quot;Away&quot;),
         FTR = case_when(venue == &quot;Home&quot; &amp; FTR == &quot;H&quot; ~ &quot;W&quot;,
                         venue == &quot;Home&quot; &amp; FTR == &quot;A&quot; ~ &quot;L&quot;,
                         venue == &quot;Away&quot; &amp; FTR == &quot;H&quot; ~ &quot;L&quot;,
                         venue == &quot;Away&quot; &amp; FTR == &quot;A&quot; ~ &quot;W&quot;,
                         TRUE ~ FTR),
         HTR = case_when(venue == &quot;Home&quot; &amp; HTR == &quot;H&quot; ~ &quot;W&quot;,
                         venue == &quot;Home&quot; &amp; HTR == &quot;A&quot; ~ &quot;L&quot;,
                         venue == &quot;Away&quot; &amp; HTR == &quot;H&quot; ~ &quot;L&quot;,
                         venue == &quot;Away&quot; &amp; HTR == &quot;A&quot; ~ &quot;W&quot;,
                         TRUE ~ HTR),
         FTGF = ifelse(venue == &quot;Home&quot;, FTHG, FTAG),  #Full Time Goals For
         FTGA = ifelse(venue == &quot;Home&quot;, FTAG, FTHG),  #Full Time Goals Against
         HTGF = ifelse(venue == &quot;Home&quot;, HTHG, HTAG),  #Half Time Goals For
         HTGA = ifelse(venue == &quot;Home&quot;, HTAG, HTHG),  #Half Time Goals Against
         goal_diff = FTGF - FTGA,                    #goal difference
         points_earned = case_when(FTR == &quot;W&quot; ~ 3,           #adding points
                                   FTR == &quot;D&quot; ~ 1,
                                   FTR == &quot;L&quot; ~ 0)) %&gt;% 
  select(Div, season, Date, team, venue, FTR, FTGF, 
         FTGA, HTR, HTGF, HTGA, goal_diff, points_earned) %&gt;%
  group_by(season, team) %&gt;%
  mutate(points = cumsum(points_earned),
         goal_diff_tot = cumsum(goal_diff)) %&gt;% #calculating the number of points each team has through out the season
  ungroup()

data_tidy</code></pre>
<pre><code>## # A tibble: 16,720 x 15
##      Div season       Date        team venue   FTR  FTGF  FTGA   HTR  HTGF
##    &lt;chr&gt;  &lt;dbl&gt;     &lt;date&gt;       &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt;
##  1    E0   1996 1995-08-19 Aston Villa  Home     W     3     1     W     3
##  2    E0   1996 1995-08-19   Blackburn  Home     W     1     0     W     1
##  3    E0   1996 1995-08-19     Chelsea  Home     D     0     0     D     0
##  4    E0   1996 1995-08-19   Liverpool  Home     W     1     0     D     0
##  5    E0   1996 1995-08-19    Man City  Home     D     1     1     L     0
##  6    E0   1996 1995-08-19   Newcastle  Home     W     3     0     W     1
##  7    E0   1996 1995-08-19 Southampton  Home     L     3     4     L     1
##  8    E0   1996 1995-08-19    West Ham  Home     L     1     2     W     1
##  9    E0   1996 1995-08-19   Wimbledon  Home     W     3     2     D     2
## 10    E0   1996 1995-08-19  Man United  Away     L     1     3     L     0
## # ... with 16,710 more rows, and 5 more variables: HTGA &lt;int&gt;,
## #   goal_diff &lt;int&gt;, points_earned &lt;dbl&gt;, points &lt;dbl&gt;,
## #   goal_diff_tot &lt;int&gt;</code></pre>
<p>To ensure that our tidying did not create any missing values, we can use the <code>summarise_all()</code> function.</p>
<pre class="r"><code>data_tidy %&gt;% 
  summarise_all(function(x) sum(is.na(x)))</code></pre>
<pre><code>## # A tibble: 1 x 15
##     Div season  Date  team venue   FTR  FTGF  FTGA   HTR  HTGF  HTGA
##   &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     0      0     0     0     0     0     0     0     0     0     0
## # ... with 4 more variables: goal_diff &lt;int&gt;, points_earned &lt;int&gt;,
## #   points &lt;int&gt;, goal_diff_tot &lt;int&gt;</code></pre>
<p>Now that we know that the data is in a tidy format, we can begin exploring the data. As an Arsenal fan, I think we should start by looking at how Arsenal has done each year.</p>
<pre class="r"><code>data_tidy %&gt;%
  filter(team == &quot;Arsenal&quot;,
         season &lt; 2007) %&gt;%
  ggplot(aes(Date, points)) +
  facet_wrap(~season, scales = &quot;free&quot;) +
  geom_line() +
  theme_tq() +
  scale_x_date(date_breaks = &quot;2 month&quot;, date_labels = &quot;%m/%d&quot;) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, 
                                   vjust = 0.5, size = 12),
        axis.text.y = element_text(size = 12),
        strip.text = element_text(size = 12),
        axis.title = element_text(size = 12)) +
  labs(x = &quot;&quot;, 
       y = &quot;Point Tally&quot;,
       title = &quot;Arsenal Point Tally over the course of each season from\nthe 1995/1996 season to the 2005/2006 season&quot;)</code></pre>
<p><img src="/post/2017-08-09-exploring-english-premier-league-historical-match-results_files/figure-html/arsenal-points-graph-1-1.png" width="800px" height="600px" /></p>
<pre class="r"><code>data_tidy %&gt;%
  filter(team == &quot;Arsenal&quot;,
         season &gt;= 2007) %&gt;%
  ggplot(aes(Date, points)) +
  facet_wrap(~season, scales = &quot;free&quot;) +
  geom_line() +
  theme_tq() +
  scale_x_date(date_breaks = &quot;2 month&quot;, 
               date_labels = &quot;%m/%d&quot;) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, 
                                   vjust = 0.5, size = 12),
        axis.text.y = element_text(size = 12),
        strip.text = element_text(size = 12),
        axis.title = element_text(size = 12))+
  labs(x = &quot;&quot;, 
       y = &quot;Point Tally&quot;,
       title = &quot;Arsenal Point Tally over the course of each season from\nthe 2006/2007 season to the 2016/2017 season&quot;)</code></pre>
<p><img src="/post/2017-08-09-exploring-english-premier-league-historical-match-results_files/figure-html/arsenal-points-graph-2-1.png" width="800px" height="600px" /></p>
<p>From these graphs, it looks like Arsenal follow a similar pattern every year, which is not surprising since the 2017 season was the first in Arsene Wenger’s tenure that they have not finished in the top 4. Looking at the plot for the 2017 season, it is clear that the period of the season that killed their chances of finishing in the top 4 was the stretch of games between February and March where their point increase flat lined. Let’s now take a look at team’s average finishing point total.</p>
<pre class="r"><code>season_ending &lt;- data_tidy %&gt;%
  group_by(season, team) %&gt;%
  summarise(final_points = max(points), 
            final_goals_for = sum(FTGF), 
            final_goals_against = sum(FTGA),
            final_goal_diff = sum(goal_diff)) %&gt;%
  ungroup() %&gt;%
  group_by(season) %&gt;%
  mutate(table_position = 20 - rank(final_points, ties.method = &quot;min&quot;)) %&gt;%
  ungroup()
  
season_ending</code></pre>
<pre><code>## # A tibble: 440 x 7
##    season        team final_points final_goals_for final_goals_against
##     &lt;dbl&gt;       &lt;chr&gt;        &lt;dbl&gt;           &lt;int&gt;               &lt;int&gt;
##  1   1996     Arsenal           63              49                  32
##  2   1996 Aston Villa           63              52                  35
##  3   1996   Blackburn           61              61                  47
##  4   1996      Bolton           29              39                  71
##  5   1996     Chelsea           50              46                  44
##  6   1996    Coventry           38              42                  60
##  7   1996     Everton           61              64                  44
##  8   1996       Leeds           43              40                  57
##  9   1996   Liverpool           71              70                  34
## 10   1996    Man City           38              33                  58
## # ... with 430 more rows, and 2 more variables: final_goal_diff &lt;int&gt;,
## #   table_position &lt;dbl&gt;</code></pre>
<p>From this output, right away we can see that point ties result in the rank function returning a tie. The EPL determines ties first by highest goal difference, and then goals for. Looking at this first example of the tie between Arsenal and Aston Villa, we can see that they both had a +17 overall goal difference but Aston Villa had 3 more goals for, meaning they finished 4th and Arsenal finished 5th. For now, we won’t worry about fixing these ties.</p>
<pre class="r"><code>season_ending_stats &lt;- season_ending %&gt;%
  group_by(team) %&gt;%
  summarise(avg_final_points = round(mean(final_points), 0), 
            sd_final_points = round(sd(final_points), 0), 
            avg_final_goals_for = round(mean(final_goals_for), 0), 
            sd_final_goals_for = round(sd(final_goals_for), 0),
            avg_final_goals_against = round(mean(final_goals_against), 0), 
            sd_final_goals_against = round(sd(final_goals_against), 0),
            avg_table_position = round(mean(table_position), 0),
            sd_table_poisiton = round(sd(table_position), 0),
            num_seasons = n())

season_ending_stats</code></pre>
<pre><code>## # A tibble: 46 x 10
##           team avg_final_points sd_final_points avg_final_goals_for
##          &lt;chr&gt;            &lt;dbl&gt;           &lt;dbl&gt;               &lt;dbl&gt;
##  1     Arsenal               75               7                  71
##  2 Aston Villa               50              11                  46
##  3    Barnsley               35             NaN                  37
##  4  Birmingham               43               7                  39
##  5   Blackburn               48              10                  48
##  6   Blackpool               39             NaN                  55
##  7      Bolton               44               9                  44
##  8 Bournemouth               44               3                  50
##  9    Bradford               31               7                  34
## 10     Burnley               34               5                  36
## # ... with 36 more rows, and 6 more variables: sd_final_goals_for &lt;dbl&gt;,
## #   avg_final_goals_against &lt;dbl&gt;, sd_final_goals_against &lt;dbl&gt;,
## #   avg_table_position &lt;dbl&gt;, sd_table_poisiton &lt;dbl&gt;, num_seasons &lt;int&gt;</code></pre>
<p>As we can see from the tibble summary, there are several teams that have only been in the premier league for a single year, resulting in NaN values for the standard deviation columns. To avoid cluttering the next graph, we will remove any teams that have not been in the premier league for at least 10 of the 22 seasons being analyzed.</p>
<pre class="r"><code>season_ending_stats %&gt;%
  filter(num_seasons &gt;= 10) %&gt;%
  arrange(-avg_final_points) %&gt;%
  mutate(team = factor(team, team)) %&gt;%
  ggplot(aes(team, avg_final_points)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;red&quot;) +
  geom_point(color = &quot;navy&quot;) +
  geom_errorbar(aes(ymin = avg_final_points - 2*sd_final_points, 
                    ymax = avg_final_points + 2*sd_final_points), 
                color = &quot;navy&quot;, size = 1) +
  theme_tq() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, 
                                   vjust = 0.5, size = 12),
        axis.text.y = element_text(size = 12),
        axis.title = element_text(size = 12)) +
  labs(x = &quot;Team&quot;,
       y = &quot;Final Points&quot;,
       title = &quot;Average Final Points from 1995/1996 season to 2016/2017 season&quot;,
       subtitle = &quot;Only teams with 10 or more seasons in the EPL were included&quot;)</code></pre>
<p><img src="/post/2017-08-09-exploring-english-premier-league-historical-match-results_files/figure-html/bar-graph-season-stats-1.png" width="800px" height="600px" /></p>
<p>It looks like Manchester United have the highest average final points per season. They are followed closely by Arsenal and Chelsea, who are then closely followed by Liverpool, Manchester City, and Tottenham. It is worth noting that Chelsea and Manchester City both have much higher error associated with their mean value, indicating they have much more fluctuation in the final point tallies. Another interesting take away from this figure is that the lowest average final point tally for teams that have been in the premier league for at least 10 of the previous 22 seasons is 39 points. 39 points typically guarantees a season that is safe from relegation. However, for the teams with the lower average finally point tally, such as Sunderland and West Brom, see the lower tails of their error bars treading dangerously close to relegation zone.</p>
<p>Now, it will be interesting to see how these teams final point tallies will look on the new joyplots from the <code>ggjoy</code> package.</p>
<pre class="r"><code>season_ending %&gt;%
  group_by(team) %&gt;%
  mutate(num_seasons = n(),
         avg_final_points = round(mean(final_points), 0)) %&gt;% #add these columns for filtering and factoring respectively
  ungroup() %&gt;%
  filter(num_seasons &gt;= 10) %&gt;%
  arrange(avg_final_points) %&gt;%
  mutate(team = factor(team, unique(team))) %&gt;%
  ggplot(aes(final_points, team)) +
  geom_joy(scale = 0.9, rel_min_height = 0.01, 
           fill = &quot;red&quot;, color = &quot;black&quot;, size = 1) +
  theme_tq()+
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 12)) +
  labs(x = &quot;Final Points&quot;,
       y = &quot;Team&quot;,
       title = &quot;Joyplot showing EPL teams&#39; individual season final point tally distribution&quot;)</code></pre>
<p><img src="/post/2017-08-09-exploring-english-premier-league-historical-match-results_files/figure-html/final-points-joyplot-1.png" width="800px" height="600px" /></p>
<p>The joyplot confirms the conclusions drawn from the bar chart. Manchester United and Arsenal have the highest final point distribution and both have close to a bell curve. However, Chelsea and Manchester City both have much wider distributions as they have much more ups and downs over the past 22 years.</p>
</div>
<div id="looking-at-opening-weekend-results" class="section level1">
<h1>Looking at opening weekend results</h1>
<p>Since this weekend marks the start of the 2017/2018 season, it will be interesting to see how teams have fared over the last 22 seasons. First, we will start by filtering for the first game of the season.</p>
<pre class="r"><code>opening_games &lt;- data_tidy %&gt;%
  group_by(season, team) %&gt;%
  mutate(final_points = max(points), 
            final_goals_for = sum(FTGF), 
            final_goals_against = sum(FTGA),
         game = rank(Date)) %&gt;%
  ungroup() %&gt;%
  group_by(season, game) %&gt;%
  mutate(table_position = 21 - min_rank(final_points)) %&gt;%
  ungroup() %&gt;%
  filter(game == 1) %&gt;%
  group_by(team) %&gt;%
  mutate(final_points_last = lag(final_points),
         final_goals_for_last = lag(final_goals_for),
         final_goals_against_last = lag(final_goals_against),
         final_table_position_last = lag(table_position)) %&gt;%
  ungroup()

opening_games</code></pre>
<pre><code>## # A tibble: 440 x 24
##      Div season       Date        team venue   FTR  FTGF  FTGA   HTR  HTGF
##    &lt;chr&gt;  &lt;dbl&gt;     &lt;date&gt;       &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt;
##  1    E0   1996 1995-08-19 Aston Villa  Home     W     3     1     W     3
##  2    E0   1996 1995-08-19   Blackburn  Home     W     1     0     W     1
##  3    E0   1996 1995-08-19     Chelsea  Home     D     0     0     D     0
##  4    E0   1996 1995-08-19   Liverpool  Home     W     1     0     D     0
##  5    E0   1996 1995-08-19    Man City  Home     D     1     1     L     0
##  6    E0   1996 1995-08-19   Newcastle  Home     W     3     0     W     1
##  7    E0   1996 1995-08-19 Southampton  Home     L     3     4     L     1
##  8    E0   1996 1995-08-19    West Ham  Home     L     1     2     W     1
##  9    E0   1996 1995-08-19   Wimbledon  Home     W     3     2     D     2
## 10    E0   1996 1995-08-19  Man United  Away     L     1     3     L     0
## # ... with 430 more rows, and 14 more variables: HTGA &lt;int&gt;,
## #   goal_diff &lt;int&gt;, points_earned &lt;dbl&gt;, points &lt;dbl&gt;,
## #   goal_diff_tot &lt;int&gt;, final_points &lt;dbl&gt;, final_goals_for &lt;int&gt;,
## #   final_goals_against &lt;int&gt;, game &lt;dbl&gt;, table_position &lt;dbl&gt;,
## #   final_points_last &lt;dbl&gt;, final_goals_for_last &lt;int&gt;,
## #   final_goals_against_last &lt;int&gt;, final_table_position_last &lt;dbl&gt;</code></pre>
<p>Now that we have a data set with all of the teams opening games results, we can look at some of the factors that could influence opening weekend results. First let’s look at how home field advantage helps teams on opening weekend</p>
<pre class="r"><code>opening_home_adv &lt;- opening_games %&gt;%
  group_by(venue) %&gt;%
  summarise(perc_W = round((sum(FTR == &quot;W&quot;)/n()) * 100, 1), 
            perc_L = round((sum(FTR == &quot;L&quot;)/n()) * 100, 1),
            perc_D = round((sum(FTR == &quot;D&quot;)/n()) * 100, 1))

opening_home_adv</code></pre>
<pre><code>## # A tibble: 2 x 4
##   venue perc_W perc_L perc_D
##   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1  Away   30.5   42.3   27.3
## 2  Home   41.8   30.9   27.3</code></pre>
<p>It looks like the home teams have better luck on the first weekend of the season than the away team. Let’s look at home this compares with the home field advantage of all games to see if there is any difference for the first week.</p>
<pre class="r"><code>home_adv &lt;- data_tidy %&gt;%
  group_by(venue) %&gt;%
  summarise(perc_W = round((sum(FTR == &quot;W&quot;)/n()) * 100, 1), 
            perc_L = round((sum(FTR == &quot;L&quot;)/n()) * 100, 1),
            perc_D = round((sum(FTR == &quot;D&quot;)/n()) * 100, 1))

home_adv</code></pre>
<pre><code>## # A tibble: 2 x 4
##   venue perc_W perc_L perc_D
##   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1  Away   27.5   46.5     26
## 2  Home   46.5   27.5     26</code></pre>
<p>It looks like the away team actually fairs slightly better on opening weekend than during the rest of the season. Let’s now take a look at the winning percentage by year for the home teams and the away teams.</p>
<pre class="r"><code>opening_games %&gt;%
  group_by(season, venue) %&gt;%
  summarise(perc_W = round((sum(FTR == &quot;W&quot;)/n()) * 100, 1), 
            perc_L = round((sum(FTR == &quot;L&quot;)/n()) * 100, 1),
            perc_D = round((sum(FTR == &quot;D&quot;)/n()) * 100, 1)) %&gt;%
  gather(key = &quot;result&quot;, value = &quot;percentage&quot;, perc_W:perc_D) %&gt;%
  mutate(result = case_when(result == &quot;perc_W&quot; ~ &quot;Winning Percentage&quot;,
                            result == &quot;perc_L&quot; ~ &quot;Losing Percentage&quot;,
                            TRUE ~ &quot;Percent Draws&quot;)) %&gt;%
  filter(venue == &quot;Home&quot;) %&gt;%
  ggplot(aes(season, percentage, color = result)) +
  geom_point() +
  geom_line(size = 1) +
  theme_tq() +
  scale_color_tq() +
  theme(axis.text.x = element_text(angle = 90, 
                                   vjust = 0.5, 
                                   hjust = 1, 
                                   size = 12),
        axis.text.y = element_text(size = 12),
        legend.title = element_blank()) +
  labs(x = &quot;Year&quot;,
       y = &quot;Percentage of Results by Year&quot;,
       title = &quot;The Percent of Results (Win, Draw, Loss) per Season\nfor Home Teams on Opening Weekend&quot;)</code></pre>
<p><img src="/post/2017-08-09-exploring-english-premier-league-historical-match-results_files/figure-html/home-adv-graph-1.png" width="800px" height="600px" /></p>
<p>It looks like the winning percentage for home teams fluctuates and there is no clear trend as to whether being home on opening weekend provides any benefit. Since 2014, the home teams have a higher losing percentage than winning percentage. Perhaps, in recent years, there has been some shift that has made playing away from home more desirable on opening weekend. Likely this is just random, however, and there is no overall benefit to being home or away. While there does not appear to be any overall inferences that can be made from playing home or away on opening weekend, looking at the winning percentage for home and away opening games for the individual teams may provide some interesting results.</p>
<pre class="r"><code>home_adv_team &lt;- opening_games %&gt;%
  group_by(team) %&gt;%
  #removing teams that have not played at least ten seasons in the premier league
  mutate(num_seasons = n()) %&gt;%
  filter(num_seasons &gt;= 10) %&gt;% 
  select(-num_seasons) %&gt;%
  ungroup() %&gt;%
  group_by(team, venue) %&gt;%
  summarise(winning_percentage = round((sum(FTR == &quot;W&quot;)/n()) * 100, 0), 
            num_games_total = n()) %&gt;%
  ungroup()

home_adv_team</code></pre>
<pre><code>## # A tibble: 36 x 4
##           team venue winning_percentage num_games_total
##          &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;           &lt;int&gt;
##  1     Arsenal  Away                 43               7
##  2     Arsenal  Home                 60              15
##  3 Aston Villa  Away                 31              13
##  4 Aston Villa  Home                 50               8
##  5   Blackburn  Away                 40               5
##  6   Blackburn  Home                 40              10
##  7      Bolton  Away                 43               7
##  8      Bolton  Home                 50               6
##  9     Chelsea  Away                 56               9
## 10     Chelsea  Home                 77              13
## # ... with 26 more rows</code></pre>
<pre class="r"><code>home_adv_team %&gt;%
  arrange(-winning_percentage) %&gt;%
  mutate(team = factor(team, unique(team)),
         venue = factor(venue, levels = c(&quot;Home&quot;, &quot;Away&quot;))) %&gt;%
  ggplot(aes(team, winning_percentage, fill = venue)) +
  facet_wrap(~venue, scales = &quot;fixed&quot;, ncol = 1) +
  geom_bar(stat = &quot;identity&quot;) +
  theme_tq() +
  scale_fill_tq() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, size = 12),
        axis.text.y = element_text(size = 12),
        strip.text = element_text(size = 12),
        legend.position = &quot;none&quot;) +
  geom_text(aes(x = team, y = winning_percentage + 5, label = paste0(&quot;n=&quot;, as.character(num_games_total)))) +
  labs(x = &quot;&quot;,
       y = &quot;Winning Percentage&quot;,
       title = &quot;Winning Percentage for Teams on Opening Weekend both Home and Away&quot;,
       subtitle = &quot;Only teams with more than 10 seasons in the premier league were included&quot;)</code></pre>
<p><img src="/post/2017-08-09-exploring-english-premier-league-historical-match-results_files/figure-html/unnamed-chunk-2-1.png" width="800px" height="600px" /></p>
<p>This figure seems to provide much more insight into how home field advantage can impact teams. For example, Arsenal have a 60% winning percentage at home on opening weekend, and their opponent this weekend, Leicester City, have not won a opening game away from home in the premier league since 1996. This is a very positive sign for the gunners as their match is being played at the Emirates Stadium (Arsenal’s Home Field). Chelsea have a winning percentage in the high 70s when they play their opening game at home, as they do this year. That fact seems promising (unfortunately) for the blues, as their opening match this year is at home. Other noticeable impacts of home field advantage are New Castle United and Sunderland. New Castle have a home winning percentage of 50% on opening weekend, but only have a 10% winning percentage for away games on opening weekend. Fortunately for them, they are also playing at home this year. Unfortunately for them, they are matched up with West Ham who don’t have much issue playing on the road opening weekend, with a 40% winning percentage when away from home. Sunderland, similarly has an average home winning percentage of just under 40% for opening weekend, but have a winning percentage of only just north of 10% when playing away from home. However, Sunderland were relegated last season, so maybe they will have better luck in the Championship. Several teams seem not to be impacted by whether or not they play at home on opening weekend. Manchester United and Manchester City both only see a slight dip in winning percentage when away from home, and Blackburn has a 40% winning percentage when both home and away on opening weekend.</p>
<p>Let’s take a look at each team’s overall winning percentage on opening weekend.</p>
<pre class="r"><code>opening_games %&gt;%
  group_by(team) %&gt;%
  #removing teams that have not played at least ten seasons in the premier league
  mutate(num_seasons = n()) %&gt;%
  filter(num_seasons &gt;= 10) %&gt;% 
  select(-num_seasons) %&gt;%
  ungroup() %&gt;%
  group_by(team) %&gt;%
  summarise(winning_percentage = round((sum(FTR == &quot;W&quot;)/n()) * 100, 0), 
            num_games_total = n()) %&gt;%
  ungroup() %&gt;%
  arrange(-winning_percentage) %&gt;%
  mutate(team = factor(team, unique(team))) %&gt;%
  ggplot(aes(team, winning_percentage)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;red&quot;, color = &quot;black&quot;) +
  theme_tq() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, size = 12),
        axis.text.y = element_text(size = 12),
        strip.text = element_text(size = 12),
        legend.position = &quot;none&quot;) +
  geom_text(aes(x = team, y = winning_percentage + 5, label = paste0(&quot;n=&quot;, as.character(num_games_total)))) +
  labs(x = &quot;&quot;,
       y = &quot;Winning Percentage&quot;,
       title = &quot;Winning Percentage for Teams on Opening Weekend&quot;,
       subtitle = &quot;Only teams with more than 10 seasons in the premier league were included&quot;)</code></pre>
<p><img src="/post/2017-08-09-exploring-english-premier-league-historical-match-results_files/figure-html/opening-win-perc-1.png" width="800px" height="600px" /></p>
<p>It looks like the results follow a similar pattern to the previous figure, as expected. Chelsea and Manchester United have the best winning percentages (&gt;60%) on opening weekend, with Arsenal, Liverpool, Manchester City, and West Ham all close behind in the 50% range.</p>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p>It looks like the odds are in favor of several of the typical powerhouse teams to perform well this weekend, if history has anything to say about it. There is much more that can be done with this data set and I hope to revisit it at a later date. I hope you all enjoyed reading this, I hope to put out more blog posts in the future!</p>
<p>And of course, COYG!!</p>
</div>
